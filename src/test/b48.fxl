#
value; std; (value; std; use "bn.fxl") \;

#trace_elapsed;
show_benchmark;

\test_add_sub_mul==
(
say "= test_add_sub_mul"
\try=
	(\x\y
	\x=(str_bn x)
	\y=(str_bn y)
	say ["x   = "(bn_str x)]
	say ["y   = "(bn_str y)]

	\z=(bn_add x y)
	say ["x+y = "(bn_str z)]

	\z=(bn_sub x y)
	say ["x-y = "(is_undef z "void"; bn_str z)]

	\z=(bn_mul x y)
	say ["x*y = "(bn_str z)]

	nl
	)

\try=
	(\x\y
	try x y
	try y x
	)

try "12345678" "12345678"

try "1" "1"

try "12345678901234567890" "98765432109876543210"
## 1219326311370217952237463801111263526900 # here
## 1219326311370217952237463801111263526900 # from bc

try "8" "4"
try "80000000" "400000"
try "9999999999999" "99999999999"
try "80000000" "0"
try "1" "9999999"
try "876543210" "876543210"
)

\test_div==
(
say "= test_div"
\try==
	(\x\y
	\x=(str_bn x)
	\y=(str_bn y)

	bn_div x y \q\r

	say ["x = "(bn_str x)]
	say ["y = "(bn_str y)]
	say ["q = "(bn_str q)]
	say ["r = "(bn_str r)]
	nl
	)

(
try "0" "0"
try "8" "0"
try "0" "8"
try "0" "988888"

try "123456789" "1234567890"
try "1234567890" "1234567890"
try "12345678901" "1234567890"
try "123456789012" "1234567890"
try "28544" "28543"
try "1" "1"
try "23" "22"
try "9233" "1234"
try "1294" "1234"
try "1235" "1234"
try "42" "12"

try "12345678901234567890" "12345678901234567890"
try "12345678901234567891" "12345678901234567890"

try "9999" "1990"
try "9999" "1000"

try "0" "1"
try "1" "2"
try "2" "1"
try "10" "238"
try "8888" "8888"

try "8" "1"
try "8" "2"
try "8" "3"
try "9" "2"
try "900" "499"
)

(
try "23" "9986"

try "5" "2"
try "5" "3"
try "10" "1"

try "10" "2"
try "10" "3"

try "238" "29"
try "23" "2"
try "23" "20"

try "23" "3"
try "23" "30"

try "238" "10"
try "2380" "29"

try "1234567890" "123456789"
try "123456789" "28543"

try "8888888888" "22"
try "8888888" "22"
try "888888" "2"

try "99990009" "27"

try "99999999" "2"
try "2" "9"

try "8888888888888888" "22222222222"
try "8888888888888888" "33333777777"
try "12345678" "2"

try "48" "8"
try "49" "8"
try "49" "47"
try "49" "48"
)

(
try "101" "2"

try "200" "2"
try "201" "2"
try "203" "2"
try "207" "2"
try "100" "1"
try "1001" "2"
try "10000001" "2"
)

(
try "3" "2"
try "300" "109"
try "245" "244"
try "244" "244"
try "243" "244"
try "28673" "199"
try "28673" "299"
try "28000" "209"
try "28000" "279"
)

(
try "10" "1"
try "10" "2"
try "10" "3"

try "888888" "2"
try "88888" "2"
try "8888" "2"
try "888" "2"
try "88" "2"

try "888888" "3"
try "88888" "3"
try "8888" "3"
try "888" "3"
try "88" "3"

try "8" "2"
try "30" "2"
try "30" "7"

try "20000" "201"

try "48" "2"
try "28" "2"
try "28" "3"
try "28000" "3"
try "18" "2"

try "28" "13"
try "28" "3"
try "286" "13"
try "286" "14"
try "146" "14"

try "28000000" "300000"

try "20000" "299"
try "20001" "20000"
try "60001" "20000"

try "8" "2"
try "30" "2"

try "4" "2"
)

(
\x="8162049548333023053472662755"
\y="1197507627300036"
try x y

\z=(bn_str; bn_add (str_bn "1234567"); bn_mul (str_bn x) (str_bn y))
try z x
)

)

\test_gcd==
(
say "= test_gcd"

\try==
	(\a\b
	\a=(str_bn a)
	\b=(str_bn b)
	\d=(bn_gcd a b)
	say ["a = "(bn_str a)]
	say ["b = "(bn_str b)]
	say ["d = "(bn_str d)]
	nl
	)

try "0" "3"
try "1" "3"
try "3" "1"
try "48" "18"
try "18" "48"
try "48" "48"

\x=(str_bn "9774116588529608940783989389983056228593747")
\y=(str_bn "1197507627300036")
\d=(str_bn "301576419113008467374")

\a=(bn_mul x d)
\b=(bn_mul y d)

(
\a=(bn_str a)
\b=(bn_str b)
try a b
)

)

test_add_sub_mul
test_div
test_gcd
