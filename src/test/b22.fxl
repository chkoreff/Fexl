# This is a regression test for an incorrect version of "define" in 15.2.0,
# fixed in 15.2.1.
#
# Incorrect:  \define=(\key\val with key (\== val))
# Correct:    \define=(\key\val with key (later val))
#
# The later function provides a necessary extra layer of deferred evaluation.

# The following line tests the incorrect definition.
##\define=(\key\val with key (\== val))

evaluate
(
define "define" define;
standard
) \;

\hello==(say "Hello.") # Should never be executed.

evaluate
(
define "hello" hello;
standard
) \;

say "BEG"
F (say "NO WAY 1" hello);

evaluate standard \;

F (say "NO WAY 2" hello);
say "END"
