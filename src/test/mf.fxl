# https://en.wikipedia.org/wiki/Hofstadter_sequence#Hofstadter_Female_and_Male_sequences

evaluate
(
:: (use "test.fxl");
:: (use_lib "time.fxl");
standard
) \;

#do_benchmark;
#trace_elapsed;

# Splice two functions f and g into a feedback loop.
\splice=(\f\g @\loop f; g loop)

# Create the base of a male/female function.
\create=
	(\base
	\cache=new_cache
	\other
	@\this\n
	\n=n
	cache n;
	le n 0 base;
	- n; other; this; - n 1
	)

\create_0=(create 0)
\create_1=(create 1)

\male   = (splice create_0 create_1)
\female = (splice create_1 create_0)

\max=35
#\max=1000

\show_sequence=
	(\label\f
	say label
	each (range 0 max) (\n put [(f n) " "])
	nl
	)

show_sequence "female" female
show_sequence "male" male
show_sequence "diff" (\n - (female n) (male n))
